<!DOCTYPE html>
<html>

<head>
  <title>Metropolis Algorithm and Phase Separation</title>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script
  type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>

<body>
  <h1>Metropolis Algorithm and Phase Separation</h1>
  <h2>Applet</h2>
  <p>
    <center>
      <applet code="Lab6.class" width="600" height="600">
      </applet>
    </center>
  </p>
  <h2>Hypothesis</h2>
  <p>
    The Metropolis Algorithm (described in methodology) can be used to
    simulate phase separation.  Temperature can be varied in simulations
    and the phenomena of simulated annealing can be observed.
  </p>
  <h2>Methodology</h2>
  <p>
    The Metropolis Algorithm is an algorithm using random variables to
    simulate the interaction of particles moving to a more favorable
    thermodynamic state.  It starts with a given initial state, which
    will be a random distribution of oil and water particles in these
    simulations.  Grids are initialized to a random distribution of
    particles with ratio given by a parameter $p$.  When the algorithm
    is called, it scans through the grid multiple times given by a
    parameter $N$.  At each point, another point is selected at random.
    It is then calculated whether swapping the two particles would
    result in a more thermodynamically favored state and a decrease in
    the energy of the system.  This is determined by looking at the
    neighbors of the particles.  Like neighbors contribute to lower
    energy states and unlike neighbors contribute to higher energy
    states.  Relative energies were assigned ($+1$ and $-1$) to each of
    the bonds.
  </p>
  <p>
    If the swap results in a lower energy state, perform it.  If not,
    there is some probability, calculated using the Boltzmann
    distribution, that the swap will still be performed.  This is to
    account for temperature, and the possibility that a system will
    reach a higher energy state in order to reach a thermodynamically
    favored one.  The form of Boltzmann's distribution that was used was
    $P(S) = e^{-\beta\Delta E}$, where $\Delta E$ is the change in energy
    (energy of the final state minus the energy of the initial state)
    and $\beta = 1/(kT)$ so that $\beta$ is inversely proportional
    to the temperature $T$. This way, the parameter $\beta$ can simply
    be changed to affect the temperature.
  </p>
  <p>
    This version of the Metropolis Algorithm implements simulated
    annealing.  In this design, temperature is decreased as time goes on
    (as time steps are counted in the simulation).  The hope for this is
    for the grid to be amply mixed and make more changes initially so
    that the system does not get stuck in a state which is not
    completely phase separated.  As time progresses, temperature is
    lowered, providing a less probability that an unfavorable change is
    made.  The program allows dynamic viewing of the simulated annealing
    phenomena.
  </p>
  <h2>Results</h2>
  <p>
    After experimenting with the parameters, an optimal grid size was
    found by letting the dimensions be 30 by 30.  With this set up, the
    simulated annealing can be properly observed, and the simulation
    does not take too long.  The tested trials were only done for an
    equal number of oil and water particles, though p could have easily
    been altered to result in a different distribution.  Letting $N =
    1000$, trials consistently phase separated.  In fact, they had
    essentially separated around $N = 500$ (the 500th scan through the
    grid).  The extra 500 time steps were to provide that all
    inconsistencies were removed.  Any lone particles in the midst of
    the particles of the opposite type at the end of the simulation were
    simply due to chance.  Refer to the attached trial run screenshots.
  </p>
  <h2>Conclusion</h2>
  <p>
    Using computer simulations, phase separation was able to be modeled.
    Principles from chemistry and physics (namely, the Boltzmann
    distribution) were used to successfully model temperature.  By
    varying temperature, simulated annealing was achieved and could be
    seen in the visual output to contribute to the complete phase
    separation of the oil and water particles.
  </p>
</body>

</html>
